#******** DO NOT EDIT THIS FILE ********#
# this file specifies common make variables for the project
SHELL = /bin/sh

CC ?= cc

USER ?= anon

CFLAGS := -Wall
LFLAGS =

assignment := csc2035-assignment1

# may have to edit the following if not on Linux or MacOS
os := $(shell uname)
ifeq ($(os),Linux)
    CFLAGS +=-g -std=c99 -D_GNU_SOURCE -D_FILE_OFFSET_BITS=64
    LFLAGS +=-lrt
    LFLAGS_SEM =-lpthread
endif

bin := bin
dist := dist
depend := depend
objects := objects
submission := submission
test := test
testbin := $(bin)/$(test)
testobjects := $(objects)/$(test)
testdepend := $(depend)/$(test)

bwait_app_sources := bwait_consumer bwait_producer
sem_app_sources := sem_consumer sem_producer

ipc_sources := ipc shobject_name
queue_sources := ipc_jobqueue jobqueue

mutex_types := lockvar noop peterson
mutex_sources := $(mutex_types:%=mutex_%)

common_sources := $(ipc_sources) job joblog proc $(queue_sources) \
    sem_ipc_jobqueue $(mutex_sources)
depend_sources := $(common_sources) $(bwait_app_sources) $(sem_app_sources)
test_sources := $(common_sources:%=$(test)_%)
testdepend_sources := $(test_sources) munit procs4tests test_jobqueue_common

submission_sources := $(queue_sources) joblog mutex_lockvar mutex_peterson \
    sem_ipc_jobqueue shobject_name

ipc_libs := $(ipc_sources:%=$(objects)/%.o)
job_lib := $(objects)/job.o
joblog_lib := $(objects)/joblog.o
proc_lib := $(objects)/proc.o
queue_libs := $(queue_sources:%=$(objects)/%.o)
sem_queue_libs := $(queue_libs) $(objects)/sem_ipc_jobqueue.o

munit_lib := $(testobjects)/munit.o
procs4tests_lib := $(testobjects)/procs4tests.o
test_jobqueue_common_lib := $(testobjects)/test_jobqueue_common.o

app_libs := $(ipc_libs) $(job_lib) $(joblog_lib) $(proc_lib) $(queue_libs)

sem_app_libs := $(ipc_libs) $(job_lib) $(joblog_lib) $(proc_lib) \
    $(sem_queue_libs)
    
test_ipc_libs := $(ipc_libs) $(munit_lib) $(proc_lib) $(procs4tests_lib)

make_depend := Makefile.dep



